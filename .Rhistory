setwd("~/Documents/publication/PtD")
pa[1]
pa = c(154, 551, 1767, 3592, 6717, 8488, 20988)
pa[1]
y = c()
pa = c(154, 551, 1767, 3592, 6717, 8488, 20988)
ba = c(39.7, 185.62, 587.12, 1337.12, 1903.84, 6278.84)
pc = c(0.1, 0.12, 0.22, 0.24, 0.32, 0.35, 0.37)
for(i in 1:30000){
if(x < pa[1]){
y[i] = 0
} else if(x < pa[2]){
y[i] = (x - pa[1]) * pc[1]
} else if(x < pa[3]){
y[i] = (x - pa[2]) * pc[2] + ba[1]
} else if(x < pa[4]){
y[i] = (x - pa[3]) * pc[3] + ba[2]
} else if(x < pa[5]){
y[i] = (x - pa[4]) * pc[4] + ba[3]
} else if(x < pa[6]){
y[i] = (x - pa[5]) * pc[5] + ba[4]
} else if(x < pa[7]){
y[i] = (x - pa[6]) * pc[6] + ba[5]
} else if(x > pa[8]){
y[i] = (x - pa[7]) * pc[7] + ba[6]
}
}
y = c()
pa = c(154, 551, 1767, 3592, 6717, 8488, 20988)
ba = c(39.7, 185.62, 587.12, 1337.12, 1903.84, 6278.84)
pc = c(0.1, 0.12, 0.22, 0.24, 0.32, 0.35, 0.37)
for(x in 1:30000){
if(x < pa[1]){
y[i] = 0
} else if(x < pa[2]){
y[i] = (x - pa[1]) * pc[1]
} else if(x < pa[3]){
y[i] = (x - pa[2]) * pc[2] + ba[1]
} else if(x < pa[4]){
y[i] = (x - pa[3]) * pc[3] + ba[2]
} else if(x < pa[5]){
y[i] = (x - pa[4]) * pc[4] + ba[3]
} else if(x < pa[6]){
y[i] = (x - pa[5]) * pc[5] + ba[4]
} else if(x < pa[7]){
y[i] = (x - pa[6]) * pc[6] + ba[5]
} else if(x > pa[8]){
y[i] = (x - pa[7]) * pc[7] + ba[6]
}
}
for(x in 1:30000){
if(x < pa[1]){
y[i] = 0
} else if(x < pa[2]){
y[i] = (x - pa[1]) * pc[1]
} else if(x < pa[3]){
y[i] = (x - pa[2]) * pc[2] + ba[1]
} else if(x < pa[4]){
y[i] = (x - pa[3]) * pc[3] + ba[2]
} else if(x < pa[5]){
y[i] = (x - pa[4]) * pc[4] + ba[3]
} else if(x < pa[6]){
y[i] = (x - pa[5]) * pc[5] + ba[4]
} else if(x < pa[7]){
y[i] = (x - pa[6]) * pc[6] + ba[5]
} else {
y[i] = (x - pa[7]) * pc[7] + ba[6]
}
}
plot(x,y)
y
y = c()
pa = c(154, 551, 1767, 3592, 6717, 8488, 20988)
ba = c(39.7, 185.62, 587.12, 1337.12, 1903.84, 6278.84)
pc = c(0.1, 0.12, 0.22, 0.24, 0.32, 0.35, 0.37)
for(i in 1:30000){
if(i < pa[1]){
y[i] = 0
} else if(i < pa[2]){
y[i] = (i - pa[1]) * pc[1]
} else if(i < pa[3]){
y[i] = (i - pa[2]) * pc[2] + ba[1]
} else if(i < pa[4]){
y[i] = (i - pa[3]) * pc[3] + ba[2]
} else if(i < pa[5]){
y[i] = (i - pa[4]) * pc[4] + ba[3]
} else if(i < pa[6]){
y[i] = (i - pa[5]) * pc[5] + ba[4]
} else if(i < pa[7]){
y[i] = (i - pa[6]) * pc[6] + ba[5]
} else {
y[i] = (i - pa[7]) * pc[7] + ba[6]
}
}
plot(i,y)
y
plot(y)
library(ggplot2)
y = data.frame(y)
y
str(y)
data = cbind(1:30000, y)
data
str(data)
colnames(data) = c("amount of wages", "Tax withholding")
str(data)
ggplot(data, aes(x = data[1], y = data[2]) +
ggplot(data, aes(x = data[1], y = data[2]) +
ggplot(data, aes(x = data[1], y = data[2])) +
geom_line(alpha = 0.5) +
ggtitle("Life expectancy over time") + theme_bw()
str(data)
data[1]
data[2]
ggplot(data, aes(x = "amount of wages", y = "Tax withholding")) +
geom_line(alpha = 0.5) +
ggtitle("Life expectancy over time") + theme_bw()
ggplot(data, aes(x = "amount of wages", y = "Tax withholding")) +
geom_line() +
ggtitle("Life expectancy over time") + theme_bw()
ggplot(data, aes(x = `amount of wages`, y = `Tax withholding``)) +
geom_line() +
ggtitle("Life expectancy over time") + theme_bw()
ggplot(data, aes(x = `amount of wages`, y = `Tax withholding`)) +
geom_line() +
ggtitle("Life expectancy over time") + theme_bw()
ggplot(data, aes(x = `Amount of wages`, y = `Tax withholding`)) +
geom_line(color = "red") +
ggtitle("Life expectancy over time") + theme_bw()
colnames(data) = c("Amount of wages", "Tax withholding")
str(data)
ggplot(data, aes(x = `Amount of wages`, y = `Tax withholding`)) +
geom_line(color = "red") +
ggtitle("Life expectancy over time") + theme_bw()
